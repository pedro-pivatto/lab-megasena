// Generated by CoffeeScript 1.12.7
(function() {
  var checkNumbers, request, reset, table;

  request = new XMLHttpRequest();

  table = [];

  request.open('GET', './info', false);

  request.onload = function() {
    table = JSON.parse(this.response);
    if (!(request.status >= 200 && request.status < 400)) {
      return console.log("error");
    }
  };

  request.send();

  checkNumbers = function(ev) {
    var contest, err, form, i, inputNum, j, k, l, len, len1, len2, m, match, n, number, numbers, ref, ref1, register, result, text;
    result = document.getElementById("result");
    form = document.forms[0];
    numbers = [];
    register = [];
    match = 0;
    text = '';
    ev.preventDefault();
    result.style.display = "block";
    for (i = j = 0; j <= 14; i = ++j) {
      if (form.elements[i].value < 0 || form.elements[i].value > 60) {
        err = 1;
      }
      while (!(form.elements[i].value.length >= 2)) {
        form.elements[i].value = "0" + form.elements[i].value;
      }
      numbers.push(form.elements[i].value);
    }
    numbers = numbers.filter(function(item, index, self) {
      return self.indexOf(item) === index;
    });
    if (numbers.length < 7) {
      err = 2;
    }

    switch (err) {
      case 1:

        msg.textContent = "Insira valores entre 1 e 60!";
        break;
      case 2:
        msg.textContent = "Insira no mínimo 6 valores diferentes!";
        break;
      default:
        for (k = 0, len = table.length; k < len; k++) {
          contest = table[k];
          ref = contest.dezenas;
          for (l = 0, len1 = ref.length; l < len1; l++) {
            number = ref[l];
            for (m = 0, len2 = numbers.length; m < len2; m++) {
              inputNum = numbers[m];
              if (inputNum === number) {
                match++;
              }
            }
          }
          if (match >= 4) {
            register.push({
              contest: contest.numero_concurso,
              matches: match
            });
          }
          match = 0;
        }
        if (register.length > 0) {
          for (i = n = 0, ref1 = register.length - 1; 0 <= ref1 ? n <= ref1 : n >= ref1; i = 0 <= ref1 ? ++n : --n) {
            text += "Você teve " + register[i].matches + " acertos no sorteio " + register[i].contest + "<br>";
          }
          msg.innerHTML = text;
        } else {
          msg.textContent = "Você não teve nenhum acerto!";
        }
    }
    return err = 0;
  };

  reset = function() {
    var msg, result;
    msg = document.getElementById("msg");
    result = document.getElementById("result");
    msg.textContent = "";
    return result.style.display = "none";
  };

  document.getElementById("button-send").addEventListener("click", checkNumbers);

  document.getElementById("button-reset").addEventListener("click", reset);

}).call(this);
